
test_that("gauss_hermite-cpp", {
  # -------------------------------------------------------------------------- #
  # 10 Gauss-Hermite quadrature points
  expected <- list(
    nodes = c(-3.43615911883774, -2.53273167423279, -1.75668364929988,
              -1.03661082978951, -0.342901327223705, 0.342901327223705,
              1.03661082978951, 1.75668364929988, 2.53273167423279,
              3.43615911883774),
    weights = c(7.64043285523267e-06, 0.00134364574678123, 0.0338743944554811,
                0.240138611082315, 0.610862633735326, 0.610862633735326,
                0.240138611082315, 0.0338743944554811, 0.00134364574678123,
                7.64043285523262e-06))

  observed <- gauss_hermite(10)
  expect_identical(observed$nodes, expected$nodes, tolerance = 1e-10)
  expect_identical(observed$weights, expected$weights, tolerance = 1e-10)


  # -------------------------------------------------------------------------- #
  # 41 Gauss-Hermite quadrature points
  expected <- list(
    nodes = c(-8.21300089559828, -7.52894546453962, -6.96035840063674,
              -6.45098459717476, -5.97936500416513, -5.53444134061345,
              -5.10956962653313,-4.70035689630412, -4.30369876715465,
              -3.91728985483778, -3.53934993736371, -3.16845945394199,
              -2.80345496148432, -2.44335955312341, -2.08733468191872,
              -1.73464560882203, -1.38463578916003, -1.03670725292421,
              -0.690305052330208,-0.344904463015433, -1.77660528296805e-16,
              0.344904463015432, 0.690305052330208, 1.03670725292421,
              1.38463578916003, 1.73464560882203, 2.08733468191872,
              2.44335955312341, 2.80345496148432, 3.16845945394199,
              3.53934993736371, 3.91728985483778, 4.30369876715465,
              4.70035689630412, 5.10956962653313, 5.53444134061344,
              5.97936500416514, 6.45098459717476, 6.96035840063674,
              7.52894546453962, 8.21300089559827),
    weights = c(
      4.00195966466661e-30, 1.47265372865202e-25, 4.86873793601306e-22,
      4.12340853753134e-19, 1.35698752958609e-16, 2.16298724717502e-14,
      1.91038336468089e-12, 1.02267989277821e-10, 3.53568164838078e-09,
      8.27265841874978e-08, 1.35737814048709e-06, 1.60559657366771e-05,
      0.000139930256596742, 0.000914234256328713, 0.00454039298730323,
      0.0173308813621168, 0.0512898723970947, 0.118484391246844,
      0.214730864490084, 0.30636781693785, 0.34482208361639, 0.306367816937852,
      0.214730864490084, 0.118484391246844,
      0.0512898723970946, 0.0173308813621168, 0.00454039298730322,
      0.000914234256328717, 0.000139930256596741, 1.60559657366773e-05,
      1.35737814048707e-06, 8.2726584187499e-08, 3.53568164838065e-09,
      1.02267989277821e-10, 1.9103833646809e-12, 2.16298724717502e-14,
      1.35698752958607e-16, 4.12340853753146e-19, 4.86873793601306e-22,
      1.47265372865213e-25, 4.00195966466661e-30))

  observed <- gauss_hermite(41)
  expect_identical(observed$nodes, expected$nodes, tolerance = 1e-10)
  expect_identical(observed$weights, expected$weights, tolerance = 1e-10)

  # -------------------------------------------------------------------------- #
  # 81 Gauss-Hermite quadrature points
  expected <- list(
    nodes = c(-11.9681194448687, -11.3632874946539, -10.8635361934286,
              -10.4182854237857, -10.0082299628279, -9.6234282602829,
              -9.25791988284923, -8.90777879781042, -8.57024675797803,
              -8.24329234044374, -7.92536437534265, -7.61524399417558,
              -7.31195084114832, -7.01468094053987, -6.72276401810913,
              -6.43563328344422, -6.15280347650822, -5.87385455999123,
              -5.59841936857891, -5.32617409394006, -5.05683084209773,
              -4.79013173178169, -4.52584415641131, -4.2637569369381,
              -4.00367716517763, -3.74542758827377, -3.4888444214602,
              -3.23377550281193, -2.98007872320255, -2.72762067922424,
              -2.47627550777353, -2.22592386932774, -1.9764520533165,
              -1.72775118391921, -1.47971650844687, -1.23224675345124,
              -0.985243536037231, -0.738610819674442, -0.492254405215337,
              -0.24608144890838, -3.278778511885e-17, 0.24608144890838,
              0.492254405215338, 0.738610819674443, 0.985243536037232,
              1.23224675345124, 1.47971650844687, 1.72775118391921,
              1.9764520533165, 2.22592386932774, 2.47627550777353,
              2.72762067922424, 2.98007872320255, 3.23377550281193,
              3.48884442146021, 3.74542758827377, 4.00367716517763,
              4.2637569369381, 4.5258441564113, 4.79013173178169,
              5.05683084209772, 5.32617409394006, 5.59841936857891,
              5.87385455999123, 6.15280347650822, 6.43563328344423,
              6.72276401810913, 7.01468094053988, 7.31195084114832,
              7.61524399417558, 7.92536437534264, 8.24329234044375,
              8.57024675797802, 8.90777879781042, 9.25791988284922,
              9.6234282602829, 10.0082299628279, 10.4182854237857,
              10.8635361934286, 11.3632874946539, 11.9681194448687),
    weights = c(
      4.34748457863078e-63, 4.50072112824898e-57, 2.60822983772177e-52,
      3.09230652021298e-48, 1.25011395754809e-44, 2.2549072526182e-41,
      2.13814214022898e-38, 1.18914593596578e-35, 4.19297342661197e-33,
      9.93168792146042e-31, 1.65222183318626e-28, 1.99956318225833e-26,
      1.81117719207087e-24, 1.25686067808588e-22, 6.81354491220429e-21,
      2.93334251839323e-19, 1.01707335710608e-17, 2.87468375672507e-16,
      6.69312693131021e-15, 1.29552042205107e-13, 2.10147965861147e-12,
      2.87706199258374e-11, 3.34534238736087e-10, 3.3221419859887e-09,
      2.83161970518297e-08, 2.08070209785328e-07, 1.32329111491444e-06,
      7.3096953196703e-06, 3.51806518403874e-05, 0.000147938741641008,
      0.000544891323817672, 0.00176173050581566, 0.00500964719374786,
      0.012549959027149, 0.0277379382199465, 0.0541548637285856,
      0.0934925822276956, 0.142840815322377, 0.193258764960801,
      0.231650634284238, 0.246066212409151, 0.231650634284238,
      0.193258764960801, 0.142840815322377, 0.0934925822276953,
      0.0541548637285855,
      0.0277379382199464, 0.0125499590271489, 0.00500964719374789,
      0.00176173050581567, 0.000544891323817676, 0.000147938741641005,
      3.51806518403873e-05, 7.30969531967043e-06, 1.32329111491442e-06,
      2.08070209785325e-07, 2.83161970518302e-08, 3.3221419859887e-09,
      3.34534238736095e-10, 2.87706199258382e-11, 2.1014796586115e-12,
      1.29552042205108e-13, 6.69312693131021e-15, 2.87468375672495e-16,
      1.01707335710615e-17, 2.93334251839304e-19, 6.81354491220395e-21,
      1.25686067808582e-22, 1.81117719207091e-24, 1.99956318225826e-26,
      1.65222183318623e-28, 9.93168792145944e-31, 4.19297342661257e-33,
      1.18914593596563e-35, 2.13814214022916e-38, 2.25490725261798e-41,
      1.25011395754807e-44, 3.09230652021347e-48, 2.60822983772184e-52,
      4.50072112824898e-57, 4.34748457863041e-63))

  observed <- gauss_hermite(81)
  expect_identical(observed$nodes, expected$nodes, tolerance = 1e-10)
  expect_identical(observed$weights, expected$weights, tolerance = 1e-10)

})
